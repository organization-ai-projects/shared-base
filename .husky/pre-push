#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# ArrÃªt en cas d'erreur
set -e

# VÃ©rification de pnpm-lock.yaml
echo "ğŸ”’ Checking pnpm-lock.yaml..."
if ! pnpm install --frozen-lockfile --prefer-offline > /dev/null 2>&1; then
  echo "âŒ Lockfile check failed. Please update pnpm-lock.yaml."
  exit 1
fi

# Lint complet
echo "ğŸ” Full linting..."
pnpm lint || exit 1

# Tests avec couverture
echo "ğŸ§ª Running tests with coverage..."
pnpm test:coverage || exit 1

# Assurer que tout est stageÃ© avant de pousser
git diff --exit-code || exit 1
